#!/bin/bash
#!/bin/bash

DIR=$1
IFS=', ' read -r -a array1 <<< "$2"

find "$DIR" -type f | while read FILE; do
    flag=0
    for i in "${array1[@]}"; do
        if echo "$(basename "$FILE")" | grep -q "$i"; then
            flag=1
            break
        fi
    done
    if [[ $flag -eq 0 ]]; then
        rm "$FILE"
    fi
done

declare -a array2=("WSS3510840,IAV_seg1_PB2"
"WSS3510841,IAV_seg2_PB1"
"WSS3510842,IAV_seg3_PA"
"WSS3510843,IAV_seg4_HA"
"WSS3510844,IAV_seg5_NP"
"WSS3510845,IAV_seg6_NA"
"WSS3510846,IAV_seg7_MP"
"WSS3510847,IAV_seg8_NS"
"WSS3510848,IAV_seg1_PB2"
"WSS3510849,IAV_seg2_PB1"
"WSS3510850,IAV_seg3_PA"
"WSS3510851,IAV_seg4_HA"
"WSS3510852,IAV_seg5_NP"
"WSS3510853,IAV_seg6_NA"
"WSS3510854,IAV_seg7_MP"
"WSS3510855,IAV_seg8_NS"
"WSS3510856,IBV_seg1_PB2"
"WSS3510857,IBV_seg2_PB1"
"WSS3510858,IBV_seg3_PA"
"WSS3510859,IBV_seg4_HA"
"WSS3510860,IBV_seg5_NP"
"WSS3510861,IBV_seg6_NA"
"WSS3510862,IBV_seg7_MP"
"WSS3510863,IBV_seg8_NS"
"WSS3510864,IBV_seg4_HA"
"WSS3510865,IBV_seg6_NA"
"WSS3510866,IAV_seg1_PB2"
"WSS3510867,IAV_seg2_PB1"
"WSS3510868,IAV_seg3_PA"
"WSS3510869,IAV_seg4_HA"
"WSS3510870,IAV_seg5_NP"
"WSS3510871,IAV_seg6_NA"
"WSS3510872,IAV_seg7_MP"
"WSS3510873,IAV_seg8_NS"
"WSS3510874,IAV_seg1_PB2"
"WSS3510875,IAV_seg2_PB1"
"WSS3510876,IAV_seg3_PA"
"WSS3510877,IAV_seg4_HA"
"WSS3510878,IAV_seg5_NP"
"WSS3510879,IAV_seg6_NA"
"WSS3510880,IAV_seg7_MP"
"WSS3510881,IAV_seg8_NS"
"WSS3510882,IBV_seg3_PA"
"WSS3510883,IBV_seg4_HA"
"WSS3510884,IBV_seg5_NP"
"WSS3510885,IBV_seg6_NA"
"WSS3510886,IBV_seg7_MP"
"WSS3510887,IBV_seg8_NS"
"WSS3510888,IBV_seg1_PB2"
"WSS3510889,IBV_seg2_PB1"
"WSS3510890,IBV_seg3_PA"
"WSS3510891,IBV_seg4_HA"
"WSS3510892,IBV_seg5_NP"
"WSS3510893,IBV_seg6_NA"
"WSS3510894,IBV_seg7_MP"
"WSS3510895,IBV_seg8_NS"
"WSS3510896,IAV_seg4_HA"
"WSS3510897,IAV_seg6_NA"
"WSS3510898,IAV_seg1_PB2"
"WSS3510899,IAV_seg2_PB1"
"WSS3510900,IAV_seg3_PA"
"WSS3510901,IAV_seg4_HA"
"WSS3510902,IAV_seg5_NP"
"WSS3510903,IAV_seg6_NA"
"WSS3510904,IAV_seg7_MP"
"WSS3510905,IAV_seg8_NS"
"WSS3510906,IBV_seg1_PB2"
"WSS3510907,IBV_seg2_PB1"
"WSS3510909,IBV_seg3_PA"
"WSS3510908,IBV_seg4_HA"
"WSS3510910,IBV_seg5_NP"
"WSS3510911,IBV_seg6_NA"
"WSS3510912,IBV_seg7_MP"
"WSS3510913,IBV_seg8_NS"
"WSS3510914,IBV_seg4_HA"
"WSS3510915,IBV_seg6_NA"
"WSS3510916,IAV_seg4_HA"
"WSS3510917,IAV_seg6_NA"
"WSS3510918,IAV_seg7_MP"
"WSS3510919,IAV_seg1_PB2"
"WSS3510920,IAV_seg2_PB1"
"WSS3510921,IAV_seg4_HA"
"WSS3510922,IAV_seg5_NP"
"WSS3510923,IAV_seg6_NA"
"WSS3510924,IAV_seg7_MP"
"WSS3510925,IAV_seg8_NS"
"WSS3510926,IBV_seg3_PA"
"WSS3510927,IBV_seg4_HA"
"WSS3510928,IBV_seg5_NP"
"WSS3510929,IBV_seg6_NA"
"WSS3510930,IBV_seg7_MP"
"WSS3510931,IBV_seg8_NS"
"WSS3510932,IBV_seg1_PB2"
"WSS3510933,IBV_seg2_PB1"
"WSS3510934,IBV_seg3_PA"
"WSS3510935,IBV_seg4_HA"
"WSS3510936,IBV_seg5_NP"
"WSS3510937,IBV_seg6_NA"
"WSS3510938,IBV_seg7_MP"
"WSS3510939,IBV_seg8_NS"
"WSS3510940,IAV_seg4_HA"
"WSS3510941,IAV_seg6_NA"
"WSS3510942,IAV_seg1_PB2"
"WSS3510943,IAV_seg2_PB1"
"WSS3510944,IAV_seg3_PA"
"WSS3510945,IAV_seg4_HA"
"WSS3510946,IAV_seg5_NP"
"WSS3510947,IAV_seg6_NA"
"WSS3510948,IAV_seg7_MP"
"WSS3510949,IAV_seg8_NS"
"WSS3510950,IBV_seg1_PB2"
"WSS3510951,IBV_seg2_PB1"
"WSS3510952,IBV_seg3_PA"
"WSS3510953,IBV_seg4_HA"
"WSS3510954,IBV_seg5_NP"
"WSS3510955,IBV_seg6_NA"
"WSS3510956,IBV_seg7_MP"
"WSS3510957,IBV_seg8_NS"
"WSS3510958,IBV_seg4_HA"
"WSS3510959,IBV_seg6_NA"
"WSS3510960,IAV_seg1_PB2"
"WSS3510961,IAV_seg2_PB1"
"WSS3510962,IAV_seg3_PA"
"WSS3510963,IAV_seg4_HA"
"WSS3510964,IAV_seg5_NP"
"WSS3510965,IAV_seg6_NA"
"WSS3510966,IAV_seg7_MP"
"WSS3510967,IAV_seg8_NS"
"WSS3510968,IAV_seg1_PB2"
"WSS3510969,IAV_seg2_PB1"
"WSS3510970,IAV_seg4_HA"
"WSS3510971,IAV_seg5_NP"
"WSS3510972,IAV_seg6_NA"
"WSS3510973,IAV_seg7_MP"
"WSS3510974,IAV_seg8_NS"
"WSS3510975,IBV_seg3_PA"
"WSS3510976,IBV_seg4_HA"
"WSS3510977,IBV_seg5_NP"
"WSS3510978,IBV_seg6_NA"
"WSS3510979,IBV_seg7_MP"
"WSS3510980,IBV_seg8_NS"
"WSS3510981,IBV_seg1_PB2"
"WSS3510982,IBV_seg2_PB1"
"WSS3510983,IBV_seg3_PA"
"WSS3510984,IBV_seg4_HA"
"WSS3510985,IBV_seg5_NP"
"WSS3510986,IBV_seg6_NA"
"WSS3510987,IBV_seg7_MP"
"WSS3510988,IBV_seg8_NS"
"WSS3511013,IAV_seg1_PB2"
"WSS3511014,IAV_seg2_PB1"
"WSS3511015,IAV_seg3_PA"
"WSS3511016,IAV_seg4_HA"
"WSS3511017,IAV_seg5_NP"
"WSS3511018,IAV_seg6_NA"
"WSS3511019,IAV_seg7_MP"
"WSS3511020,IAV_seg8_NS"
"WSS3511003,IBV_seg1_PB2"
"WSS3511004,IBV_seg2_PB1"
"WSS3511002,IBV_seg3_PA"
"WSS3510998,IBV_seg4_HA"
"WSS3510999,IBV_seg5_NP"
"WSS3510997,IBV_seg6_NA"
"WSS3511001,IBV_seg7_MP"
"WSS3511000,IBV_seg8_NS"
"WSS3511012,IAV_seg1_PB2"
"WSS3511011,IAV_seg2_PB1"
"WSS3511010,IAV_seg3_PA"
"WSS3511005,IAV_seg4_HA"
"WSS3511008,IAV_seg5_NP"
"WSS3511007,IAV_seg6_NA"
"WSS3511006,IAV_seg7_MP"
"WSS3511009,IAV_seg8_NS"
"WSS3510993,IAV_seg1_PB2"
"WSS3510994,IAV_seg2_PB1"
"WSS3510992,IAV_seg3_PA"
"WSS3510996,IAV_seg4_HA"
"WSS3510989,IAV_seg5_NP"
"WSS3510995,IAV_seg6_NA"
"WSS3510991,IAV_seg7_MP"
"WSS3510990,IAV_seg8_NS"
"KF021594.1,IAV_seg1_PB2"
"KF021595.1,IAV_seg2_PB1"
"KF021596.1,IAV_seg3_PA"
"KF021597.1,IAV_seg4_HA"
"KF021598.1,IAV_seg5_NP"
"KF021599.1,IAV_seg6_NA"
"KF021600.1,IAV_seg7_MP"
"KF021601.1,IAV_seg8_NS"
"FJ984387.1,IAV_seg1_PB2"
"GQ323558.1,IAV_seg2_PB1"
"FJ969539.1,IAV_seg3_PA"
"FJ969540.1,IAV_seg4_HA"
"FJ969536.1,IAV_seg5_NP"
"FJ984386.1,IAV_seg6_NA"
"FJ969537.1,IAV_seg7_MP"
"FJ969538.1,IAV_seg8_NS"
"CY002071.1,IAV_seg1_PB2"
"CY002070.1,IAV_seg2_PB1"
"CY002069.1,IAV_seg3_PA"
"CY002064.1,IAV_seg4_HA"
"CY002067.1,IAV_seg5_NP"
"CY002066.1,IAV_seg6_NA"
"CY002065.1,IAV_seg7_MP"
"CY002068.1,IAV_seg8_NS"
"CY040456.1,IBV_seg1_PB2"
"CY040455.1,IBV_seg2_PB1"
"CY040454.1,IBV_seg3_PA"
"CY040449.1,IBV_seg4_HA"
"CY040452.1,IBV_seg5_NP"
"CY040451.1,IBV_seg6_NA"
"CY040450.1,IBV_seg7_MP"
"CY040453.1,IBV_seg8_NS"
"AJ404630.1,IAV_seg1_PB2"
"AJ404634.1,IAV_seg2_PB1"
"AJ404637.1,IAV_seg3_PA"
"AJ404626.1,IAV_seg4_HA"
"AJ289871.1,IAV_seg5_NP"
"AJ404629.1,IAV_seg6_NA"
"AJ278646.1,IAV_seg7_MP"
"AJ278649.1,IAV_seg8_NS"
"AF144300.1,IAV_seg1_PB2"
"AF144301.1,IAV_seg2_PB1"
"AF144302.1,IAV_seg3_PA"
"AF144305.1,IAV_seg4_HA"
"AF144303.1,IAV_seg5_NP"
"AF144304.1,IAV_seg6_NA"
"AF144306.1,IAV_seg7_MP"
"AF144307.1,IAV_seg8_NS"
"CY018772.1,IBV_seg1_PB2"
"CY018771.1,IBV_seg2_PB1"
"CY018770.1,IBV_seg3_PA"
"CY018765.1,IBV_seg4_HA"
"CY018768.1,IBV_seg5_NP"
"CY018767.1,IBV_seg6_NA"
"CY018766.1,IBV_seg7_MP"
"CY018769.1,IBV_seg8_NS"
"M73524.1,IAV_seg1_PB2"
"M25935.1,IAV_seg2_PB1"
"M26079.1,IAV_seg3_PA"
"L11133.1,IAV_seg4_HA"
"AY210103.1,IAV_seg5_NP"
"AY209932.1,IAV_seg6_NA"
"M63531.1,IAV_seg7_MP"
"AY210191.1,IAV_seg8_NS"
"M14880.1,IBV_seg2_PB1"
"AF101982.1,IBV_seg1_PB2"
"AF102017.1,IBV_seg3_PA"
"K00423.1,IBV_seg4_HA"
"K01395.1,IBV_seg5_NP"
"J02095.1,IBV_seg6_NA"
"J02094.1,IBV_seg7_MP"
"J02096.1,IBV_seg8_NS"
"V00603.1,IAV_seg1_PB2"
"J02151.1,IAV_seg2_PB1"
"V01106.1,IAV_seg3_PA"
"V01088.1,IAV_seg4_HA"
"J02147.1,IAV_seg5_NP"
"J02146.1,IAV_seg6_NA"
"V01099.1,IAV_seg7_MP"
"J02150.1,IAV_seg8_NS"
)

for j in "${array2[@]}"; do
    IFS=', ' read -r -a array3 <<< "$j"
    REFSEQ="${array3[0]}"
    SUFIX="${array3[1]}"
    for h in "$DIR"/*.fa; do
        if [[ "$h" == *"$REFSEQ"* ]]; then
            SAMPLE_ID=$(basename -- "${h%%.*}")
            cp "$h" "$SAMPLE_ID"_"$SUFIX".fa
            sed -i "s#^>${SAMPLE_ID}#>${SAMPLE_ID}_${SUFIX}#" "$SAMPLE_ID"_"$SUFIX".fa
        fi
    done
done
